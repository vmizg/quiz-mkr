<div class="flex flex-col gap-2 pb-12 justify-stretch w-full max-w-4xl">
  <app-card-header
    [title]="settings?.quiz?.title"
    subtitle="Question {{ activeQuestionIndex + 1 }} of {{ questions.length }}"
    [loading]="loading"
    [visible]="!!(activeQuestion && settings)"
    icon="compass"
  >
  </app-card-header>
  <ng-container *ngIf="!loading && activeQuestion && settings">
    <sl-card
      class="question-card"
      [style]="{ '--question-count': questions.length, '--question-index': activeQuestionIndex + 1 }"
    >
      <!-- <div slot="header" class="question-card-header">
        <div class="step-indicator-wrapper">
          <div class="step-indicator font-semibold text-sm"></div>
        </div>
      </div> -->
      <sl-form style="display: contents">
        <div class="flex flex-col gap-2">
          <div class="flex flex-row items-start gap-2 text-xl">
            <sl-badge class="mt-1" pill>{{ activeQuestionIndex + 1 }}</sl-badge>
            <span class="font-semibold">{{ activeQuestion.title }}</span>
          </div>
          <div class="flex flex-row">
            <div *ngIf="!imageLoading && !!image">
              <img [src]="image" class="max-h-64" />
            </div>
            <div *ngIf="imageLoading" class="image-placeholder">
              <div>
                <sl-spinner></sl-spinner>
              </div>
            </div>
            <div *ngIf="!activeQuestion.multiSelect" class="ml-8">
              <sl-radio-group label="Select an option" no-fieldset (sl-change)="handleAnswerInput($event)">
                <sl-radio
                  *ngFor="let option of activeQuestion.options; let i = index"
                  [value]="i"
                  [checked]="activeQuestion.selectedAnswer?.has(i)"
                >
                  {{ alphabet[i] }}. {{ option.title }}
                </sl-radio>
              </sl-radio-group>
            </div>
            <div *ngIf="activeQuestion.multiSelect" class="flex flex-col ml-8">
              <sl-checkbox
                *ngFor="let option of activeQuestion.options; let i = index"
                [name]="'option-' + i"
                [checked]="activeQuestion.selectedAnswer?.has(i)"
                (sl-change)="handleAnswerInput($event, i)"
              >
                {{ alphabet[i] }}. {{ option.title }}
              </sl-checkbox>
            </div>
          </div>
        </div>
      </sl-form>
    </sl-card>
    <sl-card>
      <div class="flex flex-row justify-between items-center">
        <div class="flex flex-row gap-4">
          <sl-button (click)="handleClickPrev()" [disabled]="activeQuestionIndex === 0">Previous</sl-button>
          <sl-button type="primary" (click)="handleClickNext()" [hidden]="activeQuestionIndex === questions.length - 1"
            >Next</sl-button
          >
          <sl-button type="success" (click)="handleClickSubmit()" [hidden]="activeQuestionIndex < questions.length - 1"
            >Submit</sl-button
          >
        </div>
        <div *ngIf="settings.timeLimit" class="text-center">
          <sl-badge type="neutral" class="time-left" pill>{{ timeLeft | date: dateFmt }} </sl-badge>
        </div>
        <div class="flex flex-row gap-4">
          <sl-button (click)="handleAbandon()" type="danger" outline>Abandon</sl-button>
        </div>
      </div>
    </sl-card>
  </ng-container>
</div>
